def export_to_html(results, output_file="result.html"):
    global_total_min = 0
    global_total_eur = 0.0

    with open(output_file, "w", encoding="utf-8") as f:
        f.write("<html><head><meta charset='utf-8'>")
        f.write("<style>")
        f.write("body { font-family: Arial, sans-serif; margin: 20px; }")
        f.write("table {border-collapse: collapse; width: 100%; margin-bottom: 20px;}")
        f.write("th, td {border: 1px solid #ccc; padding: 6px; text-align: center;}")
        f.write("th {background-color: #f0f0f0;}")
        f.write(".nocturno {background-color: #ffe0e0;}")
        f.write("</style>")
        f.write("</head><body>")
        f.write("<h1>Resultados análisis PDFs</h1>")

        # Procesar cada PDF
        for filename, registros in results.items():
            total_min = sum(r["nocturnidad_minutos"] for r in registros)
            total_eur = sum(r["dinero"] for r in registros)
            global_total_min += total_min
            global_total_eur += total_eur

            f.write(f"<h2>{filename}</h2>")
            f.write("<table>")
            f.write("<tr><th>Fecha</th><th>HI</th><th>HF</th>"
                    "<th>Nocturnidad (min)</th><th>Dinero (€)</th><th>Línea completa</th></tr>")

            for r in registros:
                clase = " class='nocturno'" if r["nocturnidad_minutos"] > 0 else ""
                f.write(f"<tr{clase}>")
                f.write(f"<td>{r['fecha']}</td>")
                f.write(f"<td>{r['hi']}</td>")
                f.write(f"<td>{r['hf']}</td>")
                f.write(f"<td>{r['nocturnidad_minutos']}</td>")
                f.write(f"<td>{r['dinero']:.2f}</td>")
                f.write(f"<td>{r['linea_completa']}</td>")
                f.write("</tr>")

            f.write("</table>")
            f.write(f"<p><b>Total minutos nocturnos en {filename}: {total_min}</b></p>")
            f.write(f"<p><b>Total dinero en {filename}: {total_eur:.2f} €</b></p>")

        # Resumen global
        f.write("<hr>")
        f.write("<h2>Resumen global</h2>")
        f.write(f"<p><b>Total minutos nocturnos: {global_total_min}</b></p>")
        f.write(f"<p><b>Total dinero: {global_total_eur:.2f} €</b></p>")

        f.write("</body></html>")
